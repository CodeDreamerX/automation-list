---
interface InsertResult {
  rowNumber: number;
  slug: string;
  status: 'inserted' | 'duplicate' | 'error';
  message: string;
}

interface Props {
  insertResults: InsertResult[];
}

const { insertResults } = Astro.props;
---

<div class="bg-white rounded-lg border border-gray-200 shadow-sm p-6">
  <h3 class="text-xl font-semibold text-gray-900 mb-4">Detailed Results</h3>
  <div class="overflow-x-auto">
    <table class="min-w-full border border-gray-300">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-b border-gray-300">
            Row Number
          </th>
          <th class="px-4 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-b border-gray-300">
            Slug
          </th>
          <th class="px-4 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-b border-gray-300">
            Status
          </th>
          <th class="px-4 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-b border-gray-300">
            Message
          </th>
        </tr>
      </thead>
      <tbody>
        {insertResults.map((result, idx) => {
          let rowClass = idx % 2 === 0 ? 'bg-white' : 'bg-gray-50';
          if (result.status === 'inserted') {
            rowClass = idx % 2 === 0 ? 'bg-green-50' : 'bg-green-100';
          } else if (result.status === 'duplicate') {
            rowClass = idx % 2 === 0 ? 'bg-yellow-50' : 'bg-yellow-100';
          } else if (result.status === 'error') {
            rowClass = idx % 2 === 0 ? 'bg-red-50' : 'bg-red-100';
          }
          
          let statusBadgeClass = '';
          if (result.status === 'inserted') {
            statusBadgeClass = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800';
          } else if (result.status === 'duplicate') {
            statusBadgeClass = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800';
          } else if (result.status === 'error') {
            statusBadgeClass = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800';
          }
          
          return (
            <tr class={`${rowClass} border-b border-gray-200`}>
              <td class="px-4 py-3 text-sm text-gray-900 text-left">
                {result.rowNumber}
              </td>
              <td class="px-4 py-3 text-sm text-gray-900 text-left">
                {result.slug || <span class="text-gray-400 italic">(empty)</span>}
              </td>
              <td class="px-4 py-3 text-sm text-left">
                <span class={statusBadgeClass}>
                  {result.status}
                </span>
              </td>
              <td class="px-4 py-3 text-sm text-gray-900 text-left">
                {result.message}
              </td>
            </tr>
          );
        })}
      </tbody>
    </table>
  </div>
</div>


